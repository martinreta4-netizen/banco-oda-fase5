<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ODA ‚Äì Crucigrama del Sistema Solar (Saberes y Pensamiento Cient√≠fico)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root{
      --bg-dark:#020617;
      --primary:#0f172a;
      --accent:#4f46e5;
      --accent-2:#0ea5e9;
      --card:#ffffff;
      --border:#e2e8f0;
      --muted:#64748b;
      --success:#16a34a;
      --danger:#b91c1c;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#0f172a 0,var(--bg-dark) 40%,var(--bg-dark) 100%);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:14px 10px;
      position:relative;
      color:#0b1120;
    }
    body::before{
      content:"";
      position:fixed;
      inset:12% 18%;
      background:url("escudo_escuela.png") center/contain no-repeat;
      opacity:.03;
      pointer-events:none;
      z-index:0;
    }
    .wrapper{
      position:relative;
      z-index:1;
      width:100%;
      max-width:1100px;
      background:radial-gradient(circle at top left,#e0f2fe 0,#ffffff 35%,#e5e7eb 130%);
      border-radius:28px;
      box-shadow:0 18px 40px rgba(15,23,42,.32);
      border:1px solid #1d4ed8;
      padding:16px;
    }
    header{
      display:grid;
      grid-template-columns:auto 1fr auto;
      gap:10px;
      align-items:center;
      border-bottom:1px solid #c7d2fe;
      padding-bottom:8px;
    }
    header img{max-height:58px;width:auto;}
    @media(max-width:900px){
      header{grid-template-columns:1fr;text-align:center;}
      .logos{align-items:center;}
      .author{text-align:center;}
    }
    .logos{
      display:flex;
      flex-direction:column;
      gap:6px;
      align-items:flex-start;
    }
    .title-main{
      font-size:1.2rem;
      margin:0;
      color:#111827;
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .title-main span.icon{font-size:1.5rem;}
    .subtitle{
      margin:2px 0 0;
      font-size:.84rem;
      color:#4b5563;
    }
    .subtitle strong{color:#1d4ed8;}
    .tagline{
      display:inline-flex;
      align-items:center;
      gap:6px;
      margin-top:4px;
      padding:2px 8px;
      border-radius:999px;
      background:#e0f2fe;
      font-size:.78rem;
      color:#1d4ed8;
      font-weight:600;
    }
    .author{
      font-size:.8rem;
      color:#4b5563;
      text-align:right;
    }
    .author strong{display:block;color:#111827;font-size:.86rem;}

    main{
      display:grid;
      grid-template-columns:2fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media(max-width:960px){
      main{grid-template-columns:1fr;}
    }

    .card{
      background:var(--card);
      border-radius:18px;
      border:1px solid var(--border);
      padding:10px 11px;
      margin-bottom:8px;
    }
    .card-title{
      font-weight:600;
      font-size:.9rem;
      margin-bottom:4px;
      color:#111827;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .card-title .icon{font-size:1.1rem;}
    .card-body{font-size:.86rem;color:var(--muted);}

    .student-row{
      display:flex;
      flex-direction:column;
      gap:3px;
      font-size:.82rem;
      margin-bottom:6px;
    }
    .student-row label{
      font-weight:600;
      color:#111827;
    }
    .student-row input{
      border-radius:999px;
      border:1px solid #cbd5f5;
      padding:4px 8px;
      font-size:.83rem;
    }

    .btn-row{
      margin-top:6px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .btn{
      border-radius:999px;
      border:none;
      font-size:.8rem;
      padding:6px 10px;
      cursor:pointer;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-primary{background:#4f46e5;color:#eef2ff;}
    .btn-secondary{background:#e5e7eb;color:#111827;}
    .btn-outline{background:#fff;color:#4f46e5;border:1px solid #c7d2fe;}

    .status{
      margin-top:6px;
      font-size:.8rem;
      border-radius:10px;
      padding:6px 8px;
    }
    .status-info{background:#eef2ff;color:#4338ca;border:1px solid #c7d2fe;}
    .status-success{background:#dcfce7;color:#15803d;border:1px solid #86efac;}
    .status-error{background:#fee2e2;color:#b91c1c;border:1px solid #fecaca;}

    /* Crucigrama */
    .cw-layout{
      display:grid;
      grid-template-columns:minmax(0,1.3fr) minmax(0,1fr);
      gap:10px;
    }
    @media(max-width:780px){
      .cw-layout{grid-template-columns:1fr;}
    }
    .cw-grid-wrapper{
      overflow-x:auto;
      padding-bottom:4px;
    }
    .cw-table{
      border-collapse:collapse;
      margin-top:4px;
      margin-inline:auto;
    }
    .cw-cell{
      width:32px;
      height:32px;
      border:1px solid #94a3b8;
      position:relative;
      background:#111827;
    }
    .cw-cell.empty{
      background:#020617;
      border-color:#020617;
    }
    .cw-cell-inner{
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .cw-number{
      position:absolute;
      top:1px;
      left:2px;
      font-size:.55rem;
      color:#111827;
      z-index:2;
    }
    .cw-input{
      width:100%;
      height:100%;
      border:none;
      background:#ffffff;
      text-transform:uppercase;
      font-size:.9rem;
      text-align:center;
      outline:none;
      border-radius:0;
    }
    .cw-input.correct{
      background:#dcfce7;
    }
    .cw-input.wrong{
      background:#fee2e2;
    }

    .cw-clues h3{
      margin:4px 0;
      font-size:.86rem;
      color:#1f2937;
    }
    .cw-clues ol{
      margin:2px 0 6px 18px;
      padding:0;
      font-size:.8rem;
      color:#4b5563;
    }
    .cw-clues li{margin-bottom:3px;}

    /* Avatar */
    .avatar-card{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      text-align:center;
    }
    .avatar-circle{
      width:140px;
      height:140px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 20%,#facc15,#eab308 35%,#0f172a 90%);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      border:3px solid #fef3c7;
    }
    .avatar-circle img{
      width:100%;
      height:100%;
      object-fit:contain;
    }
    .avatar-text{
      font-size:.84rem;
      color:#111827;
    }
    .avatar-text strong{color:#4f46e5;}
    ul.steps{
      margin:4px 0 0;
      padding-left:18px;
      font-size:.8rem;
      color:#4b5563;
      text-align:left;
    }
    .steps li{margin-bottom:2px;}
    .badge-step{
      display:inline-flex;
      width:18px;
      height:18px;
      border-radius:999px;
      align-items:center;
      justify-content:center;
      background:#4f46e5;
      color:#fff;
      font-size:.72rem;
      margin-right:4px;
    }

    footer{
      margin-top:10px;
      padding-top:6px;
      border-top:1px solid #cbd5f5;
      font-size:.78rem;
      color:#6b7280;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <header>
      <div class="logos">
        <img src="sep_logo.png" alt="SEP">
        <img src="escudo_escuela.png" alt="Escuela">
      </div>
      <div>
        <h1 class="title-main"><span class="icon">üß©</span><span>Crucigrama del Sistema Solar</span></h1>
        <p class="subtitle">
          Campo formativo: <strong>Saberes y Pensamiento Cient√≠fico ¬∑ Fase 5</strong><br>
          Contenido: <em>Sistema Solar y Universo: caracter√≠sticas de sus componentes y aportaciones culturales, cient√≠ficas y tecnol√≥gicas.</em>
        </p>
        <div class="tagline">5.¬∫ grado ¬∑ Vocabulario cient√≠fico y aportaciones</div>
      </div>
      <div class="author">
        <strong>Autor: Mtro. Mart√≠n Reta</strong>
        Escuela Primaria ‚ÄúGral. L√°zaro C√°rdenas‚Äù<br>
        Ejido Santa Mar√≠a, Pesquer√≠a, N.L.
      </div>
    </header>

    <main>
      <!-- Columna izquierda: crucigrama -->
      <section>
        <div class="card">
          <div class="card-title"><span class="icon">üßë‚Äçüéì</span>Datos del alumno</div>
          <div class="card-body">
            <div class="student-row">
              <label for="studentName">Nombre del alumno(a):</label>
              <input type="text" id="studentName" placeholder="Escribe tu nombre aqu√≠">
            </div>
            <div class="student-row">
              <label for="group">Grado y grupo:</label>
              <input type="text" id="group" placeholder="Ej. 5¬∞ A">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-title"><span class="icon">üéØ</span>Prop√≥sito de esta ODA</div>
          <div class="card-body">
            Mediante la resoluci√≥n de un <strong>crucigrama interactivo</strong>, el alumno recuerda y
            usa correctamente vocabulario relacionado con las <strong>aportaciones culturales,
            cient√≠ficas y tecnol√≥gicas</strong> que han permitido conocer el Sistema Solar:
            telescopios, astr√≥nomos, movimientos y conceptos b√°sicos.
          </div>
        </div>

        <div class="card">
          <div class="card-title"><span class="icon">üß©</span>Crucigrama del Sistema Solar</div>
          <div class="card-body">
            <p style="margin-top:0;margin-bottom:4px;">
              Escribe una letra en cada cuadro blanco. Usa las pistas de
              <strong>Horizontales</strong> y <strong>Verticales</strong> para completar el crucigrama.
            </p>

            <div class="cw-layout">
              <!-- Grid -->
              <div class="cw-grid-wrapper">
                <table class="cw-table" aria-label="Crucigrama del Sistema Solar">
                  <tbody id="cw-body"></tbody>
                </table>
              </div>

              <!-- Pistas -->
              <div class="cw-clues">
                <h3>Horizontales</h3>
                <ol id="clues-across"></ol>

                <h3>Verticales</h3>
                <ol id="clues-down"></ol>
              </div>
            </div>

            <div class="btn-row">
              <button class="btn btn-primary" id="btnCheck">‚úÖ Comprobar crucigrama</button>
              <button class="btn btn-outline" id="btnClear">üßπ Borrar todo</button>
              <button class="btn btn-outline" id="btnPrintResults">üñ®Ô∏è Imprimir hoja de resultados</button>
            </div>

            <div id="cw-status" class="status status-info">
              üí° Completa el crucigrama y luego pulsa <strong>‚ÄúComprobar crucigrama‚Äù</strong> para ver tu puntaje.
            </div>
          </div>
        </div>
      </section>

      <!-- Columna derecha: avatar, PDA, voz -->
      <aside>
        <div class="card">
          <div class="card-title"><span class="icon">üõ∞Ô∏è</span>Tu gu√≠a espacial</div>
          <div class="card-body">
            <div class="avatar-card">
              <div class="avatar-circle">
                <img src="avatar_guia.png" alt="Avatar gu√≠a">
              </div>
              <div class="avatar-text">
                <strong>Hola explorador del Universo,</strong> este crucigrama te ayudar√° a recordar
                <strong>palabras clave</strong> sobre el Sistema Solar y sobre las personas y tecnolog√≠as
                que han hecho posibles sus descubrimientos.
              </div>
              <ul class="steps">
                <li><span class="badge-step">1</span>Escribe tu nombre y grupo.</li>
                <li><span class="badge-step">2</span>Lee las pistas de horizontales y verticales.</li>
                <li><span class="badge-step">3</span>Completa las letras en el crucigrama.</li>
                <li><span class="badge-step">4</span>Haz clic en <strong>‚ÄúComprobar crucigrama‚Äù</strong> y, si se pide, imprime tus resultados.</li>
              </ul>
              <div class="btn-row">
                <button class="btn btn-secondary" id="btnListen">üîä Escuchar instrucciones</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-title"><span class="icon">üìå</span>PDA vinculado</div>
          <div class="card-body" style="font-size:.8rem;">
            Este crucigrama se relaciona con el <strong>PDA de 5.¬∫ grado</strong>:
            <em>‚ÄúDescribe y valora diversas aportaciones culturales, cient√≠ficas y tecnol√≥gicas,
            entre ellas, la invenci√≥n del telescopio, para el conocimiento del Sistema Solar‚Äù.</em>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      ODA ‚Äì Crucigrama del Sistema Solar ¬∑ Saberes y Pensamiento Cient√≠fico ¬∑ Fase 5
    </footer>
  </div>

  <script>
    // Configuraci√≥n del crucigrama con palabras que se cruzan
    const crosswordConfig = {
      size: 12,
      words: [
        // HORIZONTALES
        {
          id: "SOL",
          answer: "SOL",
          clue: "Nuestra estrella m√°s cercana, fuente de luz y calor.",
          row: 2, col: 3, dir: "across", number: 1
        },
        {
          id: "LUNA",
          answer: "LUNA",
          clue: "Sat√©lite natural de la Tierra que vemos de noche.",
          row: 4, col: 0, dir: "across", number: 2
        },
        {
          id: "ASTRONOMIA",
          answer: "ASTRONOMIA",
          clue: "Ciencia que estudia los astros, como planetas, estrellas y galaxias.",
          row: 6, col: 1, dir: "across", number: 3
        },
        {
          id: "PLANETA",
          answer: "PLANETA",
          clue: "Cuerpo que gira alrededor de una estrella, como la Tierra.",
          row: 10, col: 2, dir: "across", number: 4
        },

        // VERTICALES
        {
          id: "TELESCOPIO",
          answer: "TELESCOPIO",
          clue: "Instrumento √≥ptico que permite ver objetos lejanos en el cielo con m√°s detalle.",
          row: 0, col: 5, dir: "down", number: 5
        },
        {
          id: "GALILEO",
          answer: "GALILEO",
          clue: "Cient√≠fico que perfeccion√≥ el telescopio y observ√≥ las lunas de J√∫piter.",
          row: 2, col: 0, dir: "down", number: 6
        },
        {
          id: "SONDA",
          answer: "SONDA",
          clue: "Veh√≠culo espacial sin tripulaci√≥n que viaja para estudiar otros cuerpos celestes.",
          row: 4, col: 6, dir: "down", number: 7
        },
        {
          id: "NASA",
          answer: "NASA",
          clue: "Agencia espacial de Estados Unidos que ha enviado misiones a la Luna y otros planetas.",
          row: 5, col: 10, dir: "down", number: 8
        }
      ]
    };

    const gridSize = crosswordConfig.size;
    const words = crosswordConfig.words;
    const cwBody = document.getElementById("cw-body");
    const cluesAcrossList = document.getElementById("clues-across");
    const cluesDownList = document.getElementById("clues-down");
    const statusDiv = document.getElementById("cw-status");
    let lastResults = null;

    // Mapas de celdas: letras y n√∫meros de inicio
    const cellLetters = {};
    const cellStartNumbers = {};

    function buildMaps(){
      words.forEach(word=>{
        const answer = word.answer.toUpperCase();
        const {row,col,dir,number} = word;

        // letras
        for(let i=0;i<answer.length;i++){
          const r = dir === "across" ? row : row + i;
          const c = dir === "across" ? col + i : col;
          const key = `${r}-${c}`;
          const ch = answer[i];
          if(cellLetters[key] && cellLetters[key] !== ch){
            console.warn("Conflicto de letras en",key,cellLetters[key],ch);
          }
          cellLetters[key] = ch;
        }

        // n√∫mero inicial
        const startKey = `${row}-${col}`;
        if(!cellStartNumbers[startKey] || number < cellStartNumbers[startKey]){
          cellStartNumbers[startKey] = number;
        }
      });
    }

    // Construir la tabla del crucigrama
    function buildGrid(){
      cwBody.innerHTML = "";
      for(let r=0;r<gridSize;r++){
        const tr = document.createElement("tr");
        for(let c=0;c<gridSize;c++){
          const key = `${r}-${c}`;
          const letter = cellLetters[key];
          const td = document.createElement("td");

          if(!letter){
            td.className = "cw-cell empty";
          }else{
            td.className = "cw-cell";
            const wrapper = document.createElement("div");
            wrapper.className = "cw-cell-inner";

            const num = cellStartNumbers[key];
            if(num){
              const numSpan = document.createElement("span");
              numSpan.className = "cw-number";
              numSpan.textContent = num;
              wrapper.appendChild(numSpan);
            }

            const input = document.createElement("input");
            input.className = "cw-input";
            input.maxLength = 1;
            input.autocomplete = "off";
            input.spellcheck = false;
            input.setAttribute("data-coord", key);
            input.setAttribute("data-letter", letter);

            input.addEventListener("input", e=>{
              e.target.value = e.target.value.toUpperCase();
            });

            wrapper.appendChild(input);
            td.appendChild(wrapper);
          }
          tr.appendChild(td);
        }
        cwBody.appendChild(tr);
      }
    }

    // Construir lista de pistas
    function buildClues(){
      const across = words.filter(w=>w.dir==="across").sort((a,b)=>a.number-b.number);
      const down = words.filter(w=>w.dir==="down").sort((a,b)=>a.number-b.number);

      cluesAcrossList.innerHTML = "";
      cluesDownList.innerHTML = "";

      across.forEach(w=>{
        const li = document.createElement("li");
        li.innerHTML = `<strong>${w.number}.</strong> ${w.clue}`;
        cluesAcrossList.appendChild(li);
      });
      down.forEach(w=>{
        const li = document.createElement("li");
        li.innerHTML = `<strong>${w.number}.</strong> ${w.clue}`;
        cluesDownList.appendChild(li);
      });
    }

    function clearHighlights(){
      document.querySelectorAll(".cw-input").forEach(inp=>{
        inp.classList.remove("correct","wrong");
      });
    }

    function checkCrossword(){
      clearHighlights();
      const inputs = Array.from(document.querySelectorAll(".cw-input"));
      let totalLetters = inputs.length;
      let correctLetters = 0;
      let emptyLetters = 0;

      inputs.forEach(inp=>{
        const expected = (inp.dataset.letter || "").toUpperCase();
        const value = (inp.value || "").toUpperCase();

        if(!value){
          emptyLetters++;
        }else if(value === expected){
          correctLetters++;
          inp.classList.add("correct");
        }else{
          inp.classList.add("wrong");
        }
      });

      const percent = totalLetters>0 ? Math.round((correctLetters/totalLetters)*100) : 0;

      statusDiv.className = "status";
      if(emptyLetters>0){
        statusDiv.classList.add("status-error");
        statusDiv.innerHTML = `‚ö†Ô∏è Has escrito <strong>${correctLetters}</strong> letras correctas de <strong>${totalLetters}</strong>.
        A√∫n tienes <strong>${emptyLetters}</strong> cuadros vac√≠os. Intenta completar todos antes de volver a comprobar.`;
      }else{
        statusDiv.classList.add("status-success");
        statusDiv.innerHTML = `‚úÖ ¬°Buen trabajo! Has escrito <strong>${correctLetters}</strong> letras correctas de <strong>${totalLetters}</strong>
        (${percent}%).`;
      }

      lastResults = {
        correct: correctLetters,
        total: totalLetters,
        percent,
        empty: emptyLetters,
        timestamp: new Date().toLocaleString("es-MX")
      };
    }

    function clearCrossword(){
      document.querySelectorAll(".cw-input").forEach(inp=>{
        inp.value = "";
        inp.classList.remove("correct","wrong");
      });
      statusDiv.className = "status status-info";
      statusDiv.innerHTML = "üí° Completa el crucigrama y luego pulsa <strong>‚ÄúComprobar crucigrama‚Äù</strong> para ver tu puntaje.";
      lastResults = null;
    }

    function printResults(){
      if(!lastResults){
        alert("Primero completa el crucigrama y haz clic en ‚ÄúComprobar crucigrama‚Äù para obtener tus resultados.");
        return;
      }
      const studentName = (document.getElementById("studentName").value || "___________________").trim() || "___________________";
      const group = (document.getElementById("group").value || "________").trim() || "________";

      const win = window.open("","_blank");
      win.document.write(`<!DOCTYPE html>
      <html lang="es">
      <head>
        <meta charset="UTF-8">
        <title>Hoja de resultados ‚Äì Crucigrama del Sistema Solar</title>
        <style>
          body{font-family:system-ui,-apple-system,"Segoe UI",sans-serif;padding:20px;color:#111827;}
          h1{font-size:1.2rem;margin:0 0 6px;}
          h2{font-size:1rem;margin:10px 0 4px;}
          table{border-collapse:collapse;width:100%;margin-top:8px;font-size:.9rem;}
          th,td{border:1px solid #d1d5db;padding:6px 8px;text-align:left;}
          th{background:#e5e7eb;}
          .box{border:1px solid #d1d5db;border-radius:6px;min-height:70px;margin-top:4px;}
          .small{font-size:.82rem;color:#4b5563;}
        </style>
      </head>
      <body>
        <h1>Hoja de resultados ‚Äì Crucigrama del Sistema Solar</h1>
        <p><strong>Alumno(a):</strong> ${studentName} &nbsp;&nbsp; <strong>Grado y grupo:</strong> ${group}</p>
        <p class="small"><strong>Fecha:</strong> ${lastResults.timestamp}</p>

        <h2>Procesos de desarrollo de aprendizaje (PDA)</h2>
        <p class="small">
          Describe y valora diversas aportaciones culturales, cient√≠ficas y tecnol√≥gicas,
          entre ellas la invenci√≥n del telescopio, para el conocimiento del Sistema Solar.
        </p>

        <h2>Resultados del crucigrama</h2>
        <table>
          <tr><th>Indicador</th><th>Valor</th></tr>
          <tr><td>Letras totales</td><td>${lastResults.total}</td></tr>
          <tr><td>Letras correctas</td><td>${lastResults.correct}</td></tr>
          <tr><td>Porcentaje de logro</td><td>${lastResults.percent}%</td></tr>
          <tr><td>Cuadros sin responder</td><td>${lastResults.empty}</td></tr>
        </table>

        <h2>Observaciones del docente</h2>
        <div class="box"></div>

        <h2>Compromisos de mejora del alumno(a)</h2>
        <div class="box"></div>

        <p style="margin-top:18px;font-size:.86rem;">
          Firma del alumno(a): _____________________________ &nbsp;&nbsp;
          Firma del docente: _____________________________
        </p>
      </body>
      </html>`);
      win.document.close();
      win.print();
    }

    function speakIntro(){
      const text = "Hola explorador. En este crucigrama usar√°s palabras importantes sobre el Sistema Solar y sobre los cient√≠ficos y tecnolog√≠as que nos ayudan a conocerlo. Lee cada pista de los renglones horizontales y verticales, escribe una letra en cada cuadro y, cuando termines, haz clic en Comprobar crucigrama para ver tu resultado.";
      if(!("speechSynthesis" in window)){
        alert("Tu navegador no soporta la lectura de voz. Puedes leer las instrucciones directamente en la pantalla.");
        return;
      }
      const synth = window.speechSynthesis;
      synth.cancel();
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "es-MX";
      const voices = synth.getVoices().filter(v=>v.lang && v.lang.startsWith("es"));
      if(voices.length>0) utter.voice = voices[0];
      synth.speak(utter);
    }

    document.getElementById("btnCheck").addEventListener("click", checkCrossword);
    document.getElementById("btnClear").addEventListener("click", clearCrossword);
    document.getElementById("btnPrintResults").addEventListener("click", printResults);
    document.getElementById("btnListen").addEventListener("click", speakIntro);

    // Inicializar
    buildMaps();
    buildGrid();
    buildClues();
  </script>
</body>
</html>
